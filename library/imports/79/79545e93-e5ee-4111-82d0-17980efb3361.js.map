{"version":3,"sources":["../../../../assets/script/assets/script/windowScript.js"],"names":["Emitter","require","cc","Class","extends","Component","properties","score","Node","bestScoreNumber","Label","gameBoard","leaderBoard","winBoard","loseBoard","turnNumber","_playing","onClickPlayButton","instance","emit","onClickMenuButton","_scoreUpdate","data","gameMatrix","getComponent","_tilesMatrix","flat","string","scoreNumber","forEach","element","number","_win","_lose","onClickContinueButton","_reset","onClickUndo","_show","node","runAction","moveTo","easing","easeExponentialInOut","_hide","onLoad","registerEvent","bind","leaderBoardScript","active","_bestScore","console","warn","sys","isBrowser","start"],"mappings":"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","file":"windowScript.js","sourceRoot":"../../../../assets/script","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\nconst Emitter = require('mEmitter');\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        score: cc.Node,\n        bestScoreNumber: cc.Label,\n        gameBoard: cc.Node,\n        leaderBoard: cc.Node,\n        winBoard: cc.Node,\n        loseBoard: cc.Node,\n        turnNumber: cc.Label,\n        _playing: false,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onClickPlayButton: function () {\n        Emitter.instance.emit('showWindow');\n        if (!this._playing) {\n            Emitter.instance.emit('start');\n        }\n        Emitter.instance.emit('canMove');\n        Emitter.instance.emit('playing');\n    },\n\n    onClickMenuButton: function () {\n        Emitter.instance.emit('hideWindow');\n        Emitter.instance.emit('canMove', false);\n    },\n\n    _scoreUpdate: function (data) {\n        this.gameMatrix = this.gameBoard.getComponent('gameBoard')._tilesMatrix.flat();\n        if (!this.gameMatrix) {\n            this.score.getComponent('cc.Label').string = 0;\n            return;\n        }\n        this.scoreNumber = 0;\n        this.gameMatrix.forEach(element => this.scoreNumber += element.getComponent('tilesScript').number);\n        this.score.getComponent('cc.Label').string = this.scoreNumber;\n        this.turnNumber.string = `Turn: ${data}`;\n        return;\n    },\n\n    _win: function () {\n        this.winBoard.emit('winBoard');\n        Emitter.instance.emit('sound', 'gameWin');\n        Emitter.instance.emit('notPlaying');\n    },\n\n    _lose: function () {\n        this.loseBoard.emit('loseBoard');\n        Emitter.instance.emit('sound', 'gameOver')\n        Emitter.instance.emit('notPlaying');\n    },\n\n    onClickContinueButton: function () {\n        this.gameBoard.getComponent('gameBoard')._reset();\n        if (this._playing) Emitter.instance.emit('notPlaying');\n        Emitter.instance.emit('start');\n        Emitter.instance.emit('canMove');\n        Emitter.instance.emit('playing');\n        return;\n    },\n\n    onClickUndo() {\n        Emitter.instance.emit('undo');\n        Emitter.instance.emit('sound', 'undo');\n    },\n\n    _show: function () {\n        this.node.runAction(cc.moveTo(0.5, 0, 0).easing(cc.easeExponentialInOut(0.5)));\n    },\n\n    _hide: function () {\n        this.node.runAction(cc.moveTo(0.5, -500, 0).easing(cc.easeExponentialInOut(0.5)));\n    },\n\n    onLoad() {\n        Emitter.instance.registerEvent('updateScore', this._scoreUpdate.bind(this));\n        Emitter.instance.registerEvent('lose', this._lose.bind(this));\n        Emitter.instance.registerEvent('win', this._win.bind(this));\n\n        this.leaderBoardScript = this.leaderBoard.getComponent('leaderBoardScript');\n        this.leaderBoardScript.active = false;\n        this.bestScoreNumber.string = this.leaderBoardScript._bestScore;\n\n        Emitter.instance.registerEvent('showWindow', this._show.bind(this));\n        Emitter.instance.registerEvent('hideWindow', this._hide.bind(this));\n        Emitter.instance.registerEvent('playing', () => this._playing = true);\n        Emitter.instance.registerEvent('notPlaying', () => this._playing = false);\n\n        console.warn(cc.sys.isBrowser);\n    },\n\n    start() {\n\n    },\n\n    // update (dt) {},\n});\n"]}