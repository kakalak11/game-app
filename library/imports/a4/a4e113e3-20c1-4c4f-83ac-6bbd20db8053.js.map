{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scripts\\core/assets\\scripts\\core\\ShipControl.js"],"names":["cc","Class","extends","Component","properties","bulletPrefab","Prefab","bulletHolder","Node","steerLeft","SpriteFrame","steerRight","steerForward","speed","onLoad","systemEvent","on","SystemEvent","EventType","KEY_UP","onKeyUp","KEY_DOWN","onKeyDown","_sprite","node","getComponentInChildren","Sprite","_canMoveHorizontally","_canMoveVertically","event","keyCode","macro","KEY","space","bullet","instantiate","parent","position","getPosition","isReturnToIdle","d","a","spriteFrame","horizontalTween","stop","stopVertical","w","s","verticalTween","warn","_steerHorizontal","isRight","_steerVertical","isForward","_changeStatic","tween","repeatForever","by","x","start","y"],"mappings":"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","file":"ShipControl.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\core","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        bulletPrefab: cc.Prefab,\r\n        bulletHolder: cc.Node,\r\n\r\n        steerLeft: cc.SpriteFrame,\r\n        steerRight: cc.SpriteFrame,\r\n        steerForward: cc.SpriteFrame,\r\n\r\n        speed: 500,\r\n    },\r\n\r\n    onLoad() {\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n\r\n        this._sprite = this.node.getComponentInChildren(cc.Sprite);\r\n        this._canMoveHorizontally = true;\r\n        this._canMoveVertically = true;\r\n    },\r\n\r\n    onKeyUp(event) {\r\n        if (event.keyCode == cc.macro.KEY.space) {\r\n            const bullet = cc.instantiate(this.bulletPrefab);\r\n            bullet.parent = this.bulletHolder;\r\n            bullet.position = this.node.getPosition();\r\n            return;\r\n        }\r\n        const isReturnToIdle = event.keyCode === cc.macro.KEY.d || event.keyCode === cc.macro.KEY.a;\r\n        if (isReturnToIdle) {\r\n            this._canMoveHorizontally = true;\r\n            this._sprite.spriteFrame = this.steerForward;\r\n            if (this.horizontalTween) this.horizontalTween.stop();\r\n        }\r\n\r\n        const stopVertical = event.keyCode == cc.macro.KEY.w || event.keyCode == cc.macro.KEY.s;\r\n        if (stopVertical) {\r\n            this._canMoveVertically = true;\r\n            this.verticalTween.stop();\r\n        }\r\n\r\n        cc.warn(isReturnToIdle);\r\n    },\r\n\r\n    onKeyDown(event) {\r\n        if (this._canMoveHorizontally) {\r\n            this._canMoveHorizontally = false;\r\n            if (this.horizontalTween) this.horizontalTween.stop();\r\n\r\n            if (event.keyCode == cc.macro.KEY.d) {\r\n                this._steerHorizontal({ isRight: true });\r\n            }\r\n\r\n            if (event.keyCode == cc.macro.KEY.a) {\r\n                this._steerHorizontal({ isRight: false });\r\n            }\r\n        }\r\n\r\n        if (this._canMoveVertically) {\r\n            this._canMoveVertically = false;\r\n            if (this.verticalTween) this.verticalTween.stop();\r\n\r\n            if (event.keyCode == cc.macro.KEY.w) {\r\n                this._steerVertical({ isForward: true });\r\n            }\r\n            if (event.keyCode == cc.macro.KEY.s) {\r\n                this._steerVertical({ isForward: false });\r\n            }\r\n        }\r\n    },\r\n\r\n    _steerHorizontal({ isRight = true }) {\r\n        this._changeStatic(isRight);\r\n\r\n        this.horizontalTween = cc.tween(this.node)\r\n            .repeatForever(\r\n                cc.tween()\r\n                    .by(1, { x: isRight ? this.speed : this.speed * -1 })\r\n            ).start();\r\n    },\r\n\r\n    _steerVertical({ isForward = true }) {\r\n        this.verticalTween = cc.tween(this.node)\r\n            .repeatForever(\r\n                cc.tween()\r\n                    .by(1, { y: isForward ? this.speed : this.speed * -1 })\r\n            ).start();\r\n    },\r\n\r\n    _changeStatic(isRight) {\r\n        if (isRight) this._sprite.spriteFrame = this.steerRight;\r\n        else this._sprite.spriteFrame = this.steerLeft;\r\n    }\r\n});\r\n"]}