{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scripts\\core/assets\\scripts\\core\\ShipControl.js"],"names":["cc","Class","extends","Component","properties","steerLeft","SpriteFrame","steerRight","steerForward","ship","Node","speed","onLoad","systemEvent","on","SystemEvent","EventType","KEY_UP","onKeyUp","KEY_DOWN","onKeyDown","_sprite","getComponentInChildren","Sprite","_canMoveHorizontally","_canMoveVertically","_isMovingY","_isMovingX","directionX","directionY","event","keyCode","macro","KEY","space","node","emit","position","isStopX","d","a","spriteFrame","callbackX","isStopY","w","s","callbackY","update","x","y","_changeStatic","isRight"],"mappings":"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","file":"ShipControl.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\core","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        steerLeft: cc.SpriteFrame,\r\n        steerRight: cc.SpriteFrame,\r\n        steerForward: cc.SpriteFrame,\r\n        ship: cc.Node,\r\n\r\n        speed: 500,\r\n    },\r\n\r\n    onLoad() {\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n\r\n        this._sprite = this.ship.getComponentInChildren(cc.Sprite);\r\n        this._canMoveHorizontally = true;\r\n        this._canMoveVertically = true;\r\n        this._isMovingY = true;\r\n        this._isMovingX = true;\r\n        this.directionX = 0;\r\n        this.directionY = 0;\r\n    },\r\n\r\n    onKeyUp(event) {\r\n        if (event.keyCode == cc.macro.KEY.space) {\r\n            this.node.emit('BULLET_FIRE', this.ship.position);\r\n            return;\r\n        }\r\n        const isStopX = event.keyCode === cc.macro.KEY.d || event.keyCode === cc.macro.KEY.a;\r\n        if (isStopX) {\r\n            this._sprite.spriteFrame = this.steerForward;\r\n            this.directionX = 0;\r\n            this.callbackX && this.callbackX();\r\n            this.callbackX = null;\r\n        }\r\n        const isStopY = event.keyCode == cc.macro.KEY.w || event.keyCode == cc.macro.KEY.s;\r\n        if (isStopY) {\r\n            this._canMoveVertically = true;\r\n            this.directionY = 0;\r\n            this.callbackY && this.callbackY();\r\n            this.callbackY = null;\r\n        }\r\n    },\r\n\r\n    onKeyDown(event) {\r\n        switch (event.keyCode) {\r\n            case cc.macro.KEY.d:\r\n                this.directionX = 1;\r\n                if (this.directionX != 0) this.callbackX = () => this.directionX = 1;\r\n                break;\r\n            case cc.macro.KEY.a:\r\n                this.directionX = -1;\r\n                if (this.directionX != 0) this.callbackX = () => this.directionX = -1;\r\n                break;\r\n            case cc.macro.KEY.w:\r\n                this.directionY = 1;\r\n                if (this.directionY != 0) this.callbackY = () => this.directionY = 1;\r\n                break;\r\n            case cc.macro.KEY.s:\r\n                this.directionY = -1;\r\n                if (this.directionY != 0) this.callbackY = () => this.directionY = -1;\r\n                break;\r\n        }\r\n    },\r\n\r\n    update() {\r\n        if (this._isMovingX) {\r\n            this.ship.x += this.speed * this.directionX;\r\n        }\r\n        if (this._isMovingY) {\r\n            this.ship.y += this.speed * this.directionY;\r\n        }\r\n    },\r\n\r\n    _changeStatic(isRight) {\r\n        if (isRight) this._sprite.spriteFrame = this.steerRight;\r\n        else this._sprite.spriteFrame = this.steerLeft;\r\n    }\r\n});\r\n"]}