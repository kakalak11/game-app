{"version":3,"sources":["../../../../../assets/scripts/core/assets/scripts/core/ShipControl.js"],"names":["cc","Class","extends","Component","properties","bulletPrefab","Prefab","bulletHolder","Node","steerLeft","SpriteFrame","steerRight","steerForward","speed","onLoad","systemEvent","on","SystemEvent","EventType","KEY_UP","onKeyUp","KEY_DOWN","onKeyDown","_sprite","node","getComponentInChildren","Sprite","event","keyCode","macro","KEY","space","bullet","instantiate","parent","position","getPosition","isReturnToIdle","d","a","spriteFrame","horizontalTween","stop","stopVertical","w","s","verticalTween","warn","_steerHorizontal","isRight","_steerVertical","isForward","tween","repeatForever","by","x","start","y"],"mappings":"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","file":"ShipControl.js","sourceRoot":"../../../../../assets/scripts/core","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        bulletPrefab: cc.Prefab,\n        bulletHolder: cc.Node,\n\n        steerLeft: cc.SpriteFrame,\n        steerRight: cc.SpriteFrame,\n        steerForward: cc.SpriteFrame,\n\n        speed: 500,\n    },\n\n    onLoad() {\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\n\n        this._sprite = this.node.getComponentInChildren(cc.Sprite);\n    },\n\n    onKeyUp(event) {\n        if (event.keyCode == cc.macro.KEY.space) {\n            const bullet = cc.instantiate(this.bulletPrefab);\n            bullet.parent = this.bulletHolder;\n            bullet.position = this.node.getPosition();\n        }\n\n        const isReturnToIdle = event.keyCode === cc.macro.KEY.d || event.keyCode === cc.macro.KEY.a;\n        if (isReturnToIdle) {\n            this._sprite.spriteFrame = this.steerForward;\n            if (this.horizontalTween) this.horizontalTween.stop();\n        }\n\n        const stopVertical = event.keyCode == cc.macro.KEY.w || event.keyCode == cc.macro.KEY.s;\n        if (stopVertical) this.verticalTween.stop();\n\n        cc.warn(isReturnToIdle);\n    },\n\n    onKeyDown(event) {\n        if (event.keyCode == cc.macro.KEY.d) {\n            this._steerHorizontal({ isRight: true });\n        } else if (event.keyCode == cc.macro.KEY.a) {\n            this._steerHorizontal({ isRight: false });\n        } else if (event.keyCode == cc.macro.KEY.w) {\n            this._steerVertical({ isForward: true });\n        } else if (event.keyCode == cc.macro.KEY.s) {\n            this._steerVertical({ isForward: false });\n        }\n    },\n\n    _steerHorizontal({ isRight = true }) {\n        if (isRight) this._sprite.spriteFrame = this.steerLeft;\n        else this._sprite.spriteFrame = this.steerRight;\n        if (this.horizontalTween) this.horizontalTween.stop();\n\n        this.horizontalTween = cc.tween(this.node).repeatForever(cc.tween().by(1, { x: isRight ? this.speed : this.speed * -1 })).start();\n    },\n\n    _steerVertical({ isForward = true }) {\n        if (this.verticalTween) this.verticalTween.stop();\n\n        this.verticalTween = cc.tween(this.node).repeatForever(cc.tween().by(1, { y: isForward ? this.speed : this.speed * -1 })).start();\n    },\n});\n"]}