{"version":3,"sources":["../../../../assets/script/assets/script/leaderBoardScript.js"],"names":["Emitter","require","cc","Class","extends","Component","properties","content","Node","itemPrefab","Prefab","userNameBox","EditBox","score","Label","_highScoreList","_data","_bestScore","_bestPlayer","onClickLeaderBoardButton","instance","emit","onClickReturn","onClickSave","value","string","push","setItem","length","_loadData","index","getItem","_sortData","forEach","element","array","number","parseInt","split","temp","indexOf","_updateLeaderBoard","removeAllChildren","item","instantiate","label","getComponent","addChild","_show","node","runAction","moveTo","v2","easing","easeExponentialInOut","_hide","onLoad","sys","localStorage","removeItem","registerEvent","bind","start","player"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAMA,UAAUC,QAAQ,UAAR,CAAhB;;AAEAC,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,iBAASL,GAAGM,IADJ;AAERC,oBAAYP,GAAGQ,MAFP;AAGRC,qBAAaT,GAAGU,OAHR;AAIRC,eAAOX,GAAGY,KAJF;AAKRC,wBAAgB,EALR;AAMRC,eAAO,IANC;AAORC,oBAAY,CAPJ;AAQRC,qBAAa;AARL,KAHP;;AAcL;;AAEAC,8BAA0B,oCAAY;AAClCnB,gBAAQoB,QAAR,CAAiBC,IAAjB,CAAsB,iBAAtB;AACArB,gBAAQoB,QAAR,CAAiBC,IAAjB,CAAsB,UAAtB;AACH,KAnBI;;AAqBLC,mBAAe,yBAAY;AACvBtB,gBAAQoB,QAAR,CAAiBC,IAAjB,CAAsB,iBAAtB;AACArB,gBAAQoB,QAAR,CAAiBC,IAAjB,CAAsB,UAAtB;AACH,KAxBI;;AA0BLE,iBAAa,uBAAY;AACrB,YAAIC,QAAW,KAAKb,WAAL,CAAiBc,MAA5B,SAAsC,KAAKZ,KAAL,CAAWY,MAArD;AACA,aAAKV,cAAL,CAAoBW,IAApB,CAAyBF,KAAzB;AACA,aAAKb,WAAL,CAAiBc,MAAjB,GAA0B,EAA1B;AACA,aAAKT,KAAL,CAAWW,OAAX,CAAmB,KAAKZ,cAAL,CAAoBa,MAApB,GAA6B,CAAhD,EAAmDJ,KAAnD;AACA;AACH,KAhCI;;AAkCLK,eAAW,qBAAY;AACnB,aAAK,IAAIC,QAAQ,CAAjB,EAAoBA,QAAQ,KAAKd,KAAL,CAAWY,MAAvC,EAA+CE,OAA/C,EAAwD;AACpD,gBAAI,KAAKd,KAAL,CAAWe,OAAX,CAAmBD,KAAnB,MAA8B,IAAlC,EAAwC;AACxC,iBAAKf,cAAL,CAAoBW,IAApB,CAAyB,KAAKV,KAAL,CAAWe,OAAX,CAAmBD,KAAnB,CAAzB;AACH;AACD,aAAKE,SAAL;AACA;AACH,KAzCI;;AA2CLA,eAAW,qBAAY;AAAA;;AACnB,aAAKjB,cAAL,CAAoBkB,OAApB,CAA4B,UAACC,OAAD,EAAUJ,KAAV,EAAiBK,KAAjB,EAA2B;AACnD,kBAAKC,MAAL,GAAcC,SAASH,QAAQI,KAAR,CAAc,GAAd,EAAmB,CAAnB,CAAT,CAAd;AACA,gBAAI,MAAKrB,UAAL,GAAkB,MAAKmB,MAA3B,EAAmC;AAC/B,sBAAKnB,UAAL,GAAkB,MAAKmB,MAAvB;AACA,sBAAKlB,WAAL,GAAmBgB,QAAQI,KAAR,CAAc,GAAd,EAAmB,CAAnB,CAAnB;AACA;AACH;AACJ,SAPD;AAQA,YAAIC,OAAO,KAAKxB,cAAL,CAAoB,CAApB,CAAX;AACA,aAAKA,cAAL,CAAoB,KAAKA,cAAL,CAAoByB,OAApB,CAA+B,KAAKtB,WAApC,UAAoD,KAAKD,UAAzD,CAApB,IAA8FsB,IAA9F;AACA,aAAKxB,cAAL,CAAoB,CAApB,IAA4B,KAAKG,WAAjC,UAAiD,KAAKD,UAAtD;AACA,aAAKwB,kBAAL;AACH,KAxDI;;AA0DLA,wBAAoB,8BAAY;AAAA;;AAC5B,aAAKlC,OAAL,CAAamC,iBAAb;AACA,aAAK3B,cAAL,CAAoBkB,OAApB,CAA4B,UAACC,OAAD,EAAUJ,KAAV,EAAoB;AAC5C,gBAAIa,OAAOzC,GAAG0C,WAAH,CAAe,OAAKnC,UAApB,CAAX;AACA,gBAAIoC,QAAQF,KAAKG,YAAL,CAAkB5C,GAAGY,KAArB,CAAZ;AACA,mBAAKP,OAAL,CAAawC,QAAb,CAAsBJ,IAAtB;AACA,gBAAIb,UAAU,CAAd,EAAiB;AACbe,sBAAMpB,MAAN,sBAA+BK,QAAQ,CAAvC,wBAA0DI,QAAQI,KAAR,CAAc,GAAd,EAAmB,CAAnB,CAA1D,UAAoFJ,QAAQI,KAAR,CAAc,GAAd,EAAmB,CAAnB,CAApF;AACA;AACH;AACDO,kBAAMpB,MAAN,mBAA4BK,QAAQ,CAApC,qBAAoDI,QAAQI,KAAR,CAAc,GAAd,EAAmB,CAAnB,CAApD,UAA8EJ,QAAQI,KAAR,CAAc,GAAd,EAAmB,CAAnB,CAA9E;AACH,SATD;AAUH,KAtEI;;AAwELU,WAAO,iBAAY;AACf,aAAKC,IAAL,CAAUC,SAAV,CAAoBhD,GAAGiD,MAAH,CAAU,GAAV,EAAejD,GAAGkD,EAAH,CAAM,CAAN,EAAS,CAAT,CAAf,EAA4BC,MAA5B,CAAmCnD,GAAGoD,oBAAH,CAAwB,GAAxB,CAAnC,CAApB;AACH,KA1EI;;AA4ELC,WAAO,iBAAY;AACf,aAAKN,IAAL,CAAUC,SAAV,CAAoBhD,GAAGiD,MAAH,CAAU,GAAV,EAAejD,GAAGkD,EAAH,CAAM,GAAN,EAAW,CAAX,CAAf,EAA8BC,MAA9B,CAAqCnD,GAAGoD,oBAAH,CAAwB,GAAxB,CAArC,CAApB;AACH,KA9EI;;AAgFLE,UAhFK,oBAgFI;AACL,aAAKxC,KAAL,GAAad,GAAGuD,GAAH,CAAOC,YAApB;AACA,aAAK1C,KAAL,CAAW2C,UAAX,CAAsB,OAAtB;AACA;AACA,aAAK9B,SAAL;AACA7B,gBAAQoB,QAAR,CAAiBwC,aAAjB,CAA+B,iBAA/B,EAAkD,KAAKZ,KAAL,CAAWa,IAAX,CAAgB,IAAhB,CAAlD;AACA7D,gBAAQoB,QAAR,CAAiBwC,aAAjB,CAA+B,iBAA/B,EAAkD,KAAKL,KAAL,CAAWM,IAAX,CAAgB,IAAhB,CAAlD;AACH,KAvFI;AAyFLC,SAzFK,mBAyFG;AACJ9D,gBAAQoB,QAAR,CAAiBC,IAAjB,CAAsB,QAAtB,EAAgC,EAAE0C,QAAQ,KAAK7C,WAAf,EAA4BL,OAAO,KAAKI,UAAxC,EAAhC;AACH;AA3FI;;AA6FL;AA7FJ","file":"leaderBoardScript.js","sourceRoot":"../../../../assets/script","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\nconst Emitter = require('mEmitter');\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        content: cc.Node,\n        itemPrefab: cc.Prefab,\n        userNameBox: cc.EditBox,\n        score: cc.Label,\n        _highScoreList: [],\n        _data: null,\n        _bestScore: 0,\n        _bestPlayer: '',\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onClickLeaderBoardButton: function () {\n        Emitter.instance.emit('showLeaderBoard');\n        Emitter.instance.emit('hideMenu');\n    },\n\n    onClickReturn: function () {\n        Emitter.instance.emit('hideLeaderBoard');\n        Emitter.instance.emit('showMenu');\n    },\n\n    onClickSave: function () {\n        let value = `${this.userNameBox.string}:${this.score.string}`;\n        this._highScoreList.push(value);\n        this.userNameBox.string = '';\n        this._data.setItem(this._highScoreList.length - 1, value);\n        return;\n    },\n\n    _loadData: function () {\n        for (let index = 0; index < this._data.length; index++) {\n            if (this._data.getItem(index) === null) continue;\n            this._highScoreList.push(this._data.getItem(index));\n        }\n        this._sortData();\n        return;\n    },\n\n    _sortData: function () {\n        this._highScoreList.forEach((element, index, array) => {\n            this.number = parseInt(element.split(':')[1]);\n            if (this._bestScore < this.number) {\n                this._bestScore = this.number;\n                this._bestPlayer = element.split(':')[0];\n                return;\n            }\n        });\n        let temp = this._highScoreList[0];\n        this._highScoreList[this._highScoreList.indexOf(`${this._bestPlayer}: ${this._bestScore}`)] = temp;\n        this._highScoreList[0] = `${this._bestPlayer}: ${this._bestScore}`;\n        this._updateLeaderBoard();\n    },\n\n    _updateLeaderBoard: function () {\n        this.content.removeAllChildren();\n        this._highScoreList.forEach((element, index) => {\n            let item = cc.instantiate(this.itemPrefab);\n            let label = item.getComponent(cc.Label);\n            this.content.addChild(item);\n            if (index === 0) {\n                label.string = `_____UWU_____${index + 1}_____UWU_____\\n${element.split(':')[0]}\\n${element.split(':')[1]}`;\n                return;\n            }\n            label.string = `__________${index + 1}__________\\n${element.split(':')[0]}\\n${element.split(':')[1]}`;\n        })\n    },\n\n    _show: function () {\n        this.node.runAction(cc.moveTo(0.5, cc.v2(0, 0)).easing(cc.easeExponentialInOut(0.5)));\n    },\n\n    _hide: function () {\n        this.node.runAction(cc.moveTo(0.5, cc.v2(500, 0)).easing(cc.easeExponentialInOut(0.5)));\n    },\n\n    onLoad() {\n        this._data = cc.sys.localStorage;\n        this._data.removeItem('debug');\n        // cc.log(this._data);\n        this._loadData();\n        Emitter.instance.registerEvent('showLeaderBoard', this._show.bind(this));\n        Emitter.instance.registerEvent('hideLeaderBoard', this._hide.bind(this));\n    },\n\n    start() {\n        Emitter.instance.emit('notify', { player: this._bestPlayer, score: this._bestScore });\n    },\n\n    // update (dt) {},\n});\n"]}